<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>ErgoMatrix | AI Posture Coach (Local Bot)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Inter:wght@300;400;500;600&display=swap"
    rel="stylesheet"
  />

  <style>
    :root {
      --bg-main: #f1f3f8;
      --bg-elevated: #ffffff;
      --accent: #6f94c7;
      --accent-soft: #add8e6;
      --text-main: #111827;
      --text-muted: #6b7280;
      --border-soft: rgba(15, 23, 42, 0.08);
      --shadow-soft: 0 24px 80px rgba(15, 23, 42, 0.12);
      --radius-lg: 24px;
      --radius-md: 16px;
      --radius-pill: 999px;
      --transition-fast: 0.18s ease-out;
      --transition-med: 0.3s ease-out;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
      scroll-behavior: smooth;
      background: radial-gradient(circle at top, #ffffff 0, #f1f3f8 45%, #e2e8f0 100%);
      color: var(--text-main);
      font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      overflow-x: hidden;
    }

    body::before {
      content: "";
      position: fixed;
      inset: 0;
      pointer-events: none;
      background-image:
        radial-gradient(circle at 10% 0%, rgba(173, 216, 230, 0.26), transparent 55%),
        radial-gradient(circle at 90% 100%, rgba(111, 148, 199, 0.24), transparent 55%);
      opacity: 0.9;
      z-index: -1;
    }

    /* Floating header */
    header {
      position: fixed;
      inset-inline: 0;
      top: 0;
      z-index: 50;
      display: flex;
      justify-content: center;
      padding: 16px 0;
      pointer-events: none;
    }

    .nav-shell {
      width: min(1180px, 100% - 32px);
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 10px;
      padding: 10px 18px;
      border-radius: var(--radius-pill);
      background: linear-gradient(
          135deg,
          rgba(173, 216, 230, 0.55),
          rgba(255, 255, 255, 0.96),
          rgba(111, 148, 199, 0.16)
        );
      backdrop-filter: blur(18px);
      border: 1px solid rgba(148, 163, 184, 0.4);
      box-shadow: 0 20px 50px rgba(15, 23, 42, 0.15);
      pointer-events: auto;
      transition: transform var(--transition-med), background var(--transition-fast),
        border-color var(--transition-fast), box-shadow var(--transition-fast);
    }

    .nav-shell.scrolled {
      transform: translateY(-6px) scale(0.98);
      background: linear-gradient(
          135deg,
          rgba(173, 216, 230, 0.28),
          rgba(241, 243, 248, 0.98),
          rgba(111, 148, 199, 0.18)
        );
      border-color: rgba(111, 148, 199, 0.7);
      box-shadow: 0 18px 60px rgba(15, 23, 42, 0.18);
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 8px;
      text-decoration: none;
      color: var(--text-main);
    }

    .logo-img {
      width: 32px;
      height: 32px;
      border-radius: 10px;
      object-fit: cover;
      box-shadow:
        0 0 12px rgba(173, 216, 230, 0.9),
        0 0 22px rgba(111, 148, 199, 0.7);
    }

    .logo-text-main {
      font-family: "Orbitron", system-ui, sans-serif;
      font-size: 1.1rem;
      letter-spacing: 0.16em;
      text-transform: uppercase;
    }

    .logo-text-sub {
      font-size: 0.68rem;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.18em;
    }

    nav {
      display: flex;
      align-items: center;
      gap: 16px;
      flex-wrap: wrap;
      font-size: 0.82rem;
    }

    nav a {
      position: relative;
      color: var(--text-muted);
      text-decoration: none;
      padding: 6px 10px;
      border-radius: 999px;
      transition: color var(--transition-fast), background var(--transition-fast), transform var(--transition-fast);
    }

    nav a::after {
      content: "";
      position: absolute;
      left: 12px;
      right: 12px;
      bottom: 3px;
      height: 1px;
      background: linear-gradient(to right, transparent, var(--accent), transparent);
      opacity: 0;
      transform: scaleX(0.25);
      transform-origin: center;
      transition: opacity var(--transition-fast), transform var(--transition-fast);
    }

    nav a:hover {
      color: #0f172a;
      background: rgba(148, 163, 184, 0.08);
      transform: translateY(-1px);
    }

    nav a:hover::after {
      opacity: 1;
      transform: scaleX(1);
    }

    .nav-cta {
      margin-left: 4px;
      padding: 8px 16px;
      border-radius: var(--radius-pill);
      background: radial-gradient(circle at 0 0, rgba(241, 243, 248, 0.9), transparent 55%),
        linear-gradient(120deg, #6f94c7, #add8e6, #4876b0);
      color: #0b1220;
      font-size: 0.8rem;
      font-weight: 600;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      border: none;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      box-shadow:
        0 0 12px rgba(111, 148, 199, 0.65),
        0 12px 30px rgba(15, 23, 42, 0.4);
      transform-origin: center;
      transition: transform var(--transition-fast), box-shadow var(--transition-fast), filter var(--transition-fast);
    }

    .nav-cta:hover {
      transform: translateY(-1px) scale(1.03);
      box-shadow:
        0 0 18px rgba(111, 148, 199, 0.85),
        0 16px 38px rgba(15, 23, 42, 0.55);
      filter: brightness(1.03);
    }

    .nav-cta span {
      font-size: 0.9em;
    }

    .nav-cta-dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: #0b1220;
      box-shadow: 0 0 12px rgba(15, 23, 42, 0.7);
    }

    main {
      min-height: 100vh;
      padding-top: 96px;
      padding-bottom: 80px;
    }

    .shell {
      width: min(1180px, 100% - 32px);
      margin: 0 auto;
    }

    /* Layout */
    .page-header {
      padding: 32px 0 16px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .page-pill {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 4px 10px 4px 4px;
      border-radius: 999px;
      border: 1px solid rgba(111, 148, 199, 0.8);
      background: radial-gradient(circle at 0 0, rgba(173, 216, 230, 0.6), transparent 60%);
      color: var(--text-muted);
      font-size: 0.72rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      width: fit-content;
    }

    .page-pill-dot {
      width: 18px;
      height: 18px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 30%, #ffffff 0, #add8e6 40%, #6f94c7 100%);
      box-shadow:
        0 0 14px rgba(173, 216, 230, 0.9),
        0 0 26px rgba(111, 148, 199, 0.7);
    }

    .page-title {
      font-family: "Orbitron", system-ui, sans-serif;
      font-size: clamp(1.7rem, 3vw, 2.3rem);
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: #0b1120;
    }

    .page-title span {
      background: linear-gradient(120deg, #4876b0, #6f94c7, #add8e6);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }

    .page-subtitle {
      font-size: 0.9rem;
      color: var(--text-muted);
      max-width: 580px;
      line-height: 1.7;
    }

    .layout {
      display: grid;
      grid-template-columns: minmax(0, 0.9fr) minmax(0, 1.3fr);
      gap: 18px;
      margin-top: 16px;
      align-items: stretch;
    }

    /* Sidebar with examples */
    .sidebar {
      border-radius: var(--radius-lg);
      background: rgba(255, 255, 255, 0.98);
      border: 1px solid var(--border-soft);
      padding: 16px 14px 18px;
      box-shadow: 0 16px 60px rgba(15, 23, 42, 0.14);
      font-size: 0.84rem;
      color: var(--text-muted);
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .sidebar-title {
      font-size: 0.86rem;
      text-transform: uppercase;
      letter-spacing: 0.18em;
      color: var(--text-muted);
    }

    .sidebar-chip {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 9px;
      border-radius: var(--radius-pill);
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: rgba(248, 250, 252, 0.96);
      font-size: 0.72rem;
      color: var(--text-muted);
    }

    .sidebar-chip-dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: rgba(111, 148, 199, 0.9);
      box-shadow: 0 0 12px rgba(111, 148, 199, 0.7);
    }

    .sidebar-section-title {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: #6f94c7;
      margin-top: 4px;
    }

    .example-list {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .example-pill {
      font-size: 0.78rem;
      padding: 7px 10px;
      border-radius: var(--radius-pill);
      background: rgba(248, 250, 252, 0.96);
      border: 1px solid rgba(148, 163, 184, 0.5);
      cursor: pointer;
      font-family: inherit;
      color: var(--text-main);
      text-align: left;
      transition: border-color var(--transition-fast), background var(--transition-fast), transform var(--transition-fast);
    }

    .example-pill:hover {
      border-color: rgba(111, 148, 199, 0.8);
      background: #f0f5fb;
      transform: translateX(2px);
    }

    .example-pill:focus {
      outline: 2px solid rgba(111, 148, 199, 0.7);
      outline-offset: 2px;
    }

    .sidebar-footer {
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-top: 6px;
    }

    /* Chat container */
    .chat-shell {
      border-radius: var(--radius-lg);
      background: rgba(255, 255, 255, 0.98);
      border: 1px solid var(--border-soft);
      box-shadow: 0 18px 70px rgba(15, 23, 42, 0.16);
      display: flex;
      flex-direction: column;
      height: min(640px, calc(100vh - 150px));
    }

    .chat-header {
      padding: 12px 14px;
      border-bottom: 1px solid rgba(148, 163, 184, 0.3);
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
    }

    .chat-badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .chat-avatar {
      width: 26px;
      height: 26px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 30%, #ffffff 0, #add8e6 40%, #6f94c7 100%);
      box-shadow:
        0 0 14px rgba(173, 216, 230, 0.9),
        0 0 26px rgba(111, 148, 199, 0.6);
    }

    .chat-meta {
      font-size: 0.78rem;
    }

    .chat-meta-title {
      color: var(--text-main);
    }

    .chat-meta-sub {
      color: var(--text-muted);
      font-size: 0.72rem;
    }

    .chat-controls {
      display: inline-flex;
      gap: 6px;
      align-items: center;
      font-size: 0.72rem;
      color: var(--text-muted);
    }

    .chat-control-btn {
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: rgba(248, 250, 252, 0.96);
      padding: 4px 8px;
      font-size: 0.7rem;
      cursor: pointer;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: var(--text-muted);
      font-family: inherit;
      transition: border-color var(--transition-fast), color var(--transition-fast);
    }

    .chat-control-btn:hover {
      border-color: rgba(111, 148, 199, 0.8);
      color: #4876b0;
    }

    .chat-control-btn:focus {
      outline: 2px solid rgba(111, 148, 199, 0.7);
      outline-offset: 2px;
    }

    .chat-body {
      flex: 1;
      padding: 12px 14px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 8px;
      font-size: 0.84rem;
    }

    .msg-row {
      display: flex;
      gap: 8px;
      max-width: 92%;
    }

    .msg-row.user {
      justify-content: flex-end;
      margin-left: auto;
    }

    .msg-avatar {
      width: 22px;
      height: 22px;
      border-radius: 999px;
      background: rgba(148, 163, 184, 0.3);
      flex-shrink: 0;
    }

    .msg-bubble {
      padding: 8px 10px;
      border-radius: 16px;
      line-height: 1.6;
      border: 1px solid transparent;
      background: rgba(248, 250, 252, 0.96);
      color: var(--text-main);
    }

    .msg-row.user .msg-bubble {
      background: linear-gradient(135deg, #6f94c7, #add8e6);
      color: #0b1220;
      border-color: rgba(15, 23, 42, 0.08);
      border-bottom-right-radius: 4px;
    }

    .msg-row.bot .msg-bubble {
      background: rgba(255, 255, 255, 0.98);
      border-color: rgba(148, 163, 184, 0.5);
      border-bottom-left-radius: 4px;
    }

    .msg-meta {
      font-size: 0.7rem;
      color: var(--text-muted);
      margin-top: 2px;
    }

    .msg-row.user .msg-meta {
      text-align: right;
    }

    .typing-indicator {
      display: none;
      align-items: center;
      gap: 6px;
      font-size: 0.78rem;
      color: var(--text-muted);
      padding: 4px 2px;
    }

    .dot {
      width: 4px;
      height: 4px;
      border-radius: 999px;
      background: rgba(111, 148, 199, 0.9);
      animation: bounce 1s infinite;
    }

    .dot:nth-child(2) {
      animation-delay: 0.15s;
    }

    .dot:nth-child(3) {
      animation-delay: 0.3s;
    }

    @keyframes bounce {
      0%, 100% {
        transform: translateY(0);
      }
      50% {
        transform: translateY(-2px);
      }
    }

    .chat-footer {
      padding: 10px 12px;
      border-top: 1px solid rgba(148, 163, 184, 0.3);
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .input-row {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .sr-only {
      position: absolute;
      left: -10000px;
      width: 1px;
      height: 1px;
      overflow: hidden;
    }

    .prompt-input {
      flex: 1;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: rgba(248, 250, 252, 0.96);
      color: var(--text-main);
      padding: 8px 12px;
      font-size: 0.84rem;
      outline: none;
      font-family: inherit;
      transition: border-color var(--transition-fast);
    }

    .prompt-input::placeholder {
      color: rgba(107, 114, 128, 0.7);
    }

    .prompt-input:focus {
      border-color: rgba(111, 148, 199, 0.8);
    }

    .send-btn {
      border-radius: 999px;
      border: none;
      background: linear-gradient(120deg, #6f94c7, #add8e6, #4876b0);
      color: #0b1220;
      padding: 8px 14px;
      font-size: 0.78rem;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      cursor: pointer;
      box-shadow:
        0 0 18px rgba(111, 148, 199, 0.6),
        0 10px 26px rgba(15, 23, 42, 0.3);
      font-family: inherit;
      transition: transform var(--transition-fast), filter var(--transition-fast);
    }

    .send-btn:hover {
      transform: translateY(-1px) scale(1.02);
      filter: brightness(1.05);
    }

    .send-btn:focus {
      outline: 2px solid rgba(111, 148, 199, 0.9);
      outline-offset: 2px;
    }

    .footer-meta {
      font-size: 0.7rem;
      color: var(--text-muted);
      display: flex;
      justify-content: space-between;
      gap: 10px;
      flex-wrap: wrap;
    }

    @media (max-width: 900px) {
      .layout {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    @media (max-width: 720px) {
      nav {
        display: none;
      }

      .chat-shell {
        height: calc(100vh - 150px);
      }
    }

    /* Footer */
    footer {
      border-top: 1px solid rgba(111, 148, 199, 0.6);
      padding: 18px 0 22px;
      background: radial-gradient(circle at 50% 0, rgba(173, 216, 230, 0.4), transparent 65%);
    }

    .footer-shell {
      width: min(1180px, 100% - 32px);
      margin: 0 auto;
      text-align: center;
    }

    .footer-name {
      font-family: "Orbitron", system-ui, sans-serif;
      font-size: clamp(1.9rem, 4vw, 2.6rem);
      letter-spacing: 0.32em;
      text-transform: uppercase;
      background: linear-gradient(120deg, #4876b0, #6f94c7, #add8e6);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      text-shadow:
        0 0 24px rgba(111, 148, 199, 0.9),
        0 0 40px rgba(148, 163, 184, 1);
      margin-bottom: 8px;
    }

    .footer-credits {
      font-size: 0.8rem;
      color: var(--text-muted);
      margin-bottom: 6px;
    }

    .footer-credits span {
      color: #1d4ed8;
    }

    .footer-links {
      font-size: 0.7rem;
      color: var(--text-muted);
      display: flex;
      justify-content: center;
      gap: 16px;
      flex-wrap: wrap;
    }

    .footer-links a {
      color: var(--text-muted);
      text-decoration: none;
    }

    .footer-links a:hover {
      color: #4876b0;
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <header>
    <div class="nav-shell" id="navShell">
      <a href="index.html" class="logo">
        <img src="img.png" alt="ErgoMatrix logo" class="logo-img" />
        <div>
          <div class="logo-text-main">ErgoMatrix</div>
          <div class="logo-text-sub">Posture Pro System</div>
        </div>
      </a>
      <nav>
        <a href="about.html">About & Future</a>
        <a href="products.html">Products</a>
        <a href="how-to-use.html">How To Use</a>
        <a href="ai-chatbot.html">AI Posture Coach</a>
        <a href="credits.html">Credits</a>
      </nav>
      <button class="nav-cta" onclick="window.location.href='products.html'">
        <span>Buy Posture Pro</span>
        <span class="nav-cta-dot"></span>
      </button>
    </div>
  </header>

  <main>
    <div class="shell">
      <section class="page-header">
        <div class="page-pill">
          <div class="page-pill-dot"></div>
          <span>AI-powered posture coach</span>
        </div>
        <h1 class="page-title">
          Ask about <span>ErgoMatrix & posture</span>.
        </h1>
        <p class="page-subtitle">
          This AI coach answers questions about ErgoMatrix, the Posture Pro system, Eye-Q Sensor,
          Mesh-Up, and posture tips for desk workers using Google Gemini.
        </p>
      </section>

      <section class="layout">
        <!-- Sidebar -->
        <aside class="sidebar" aria-label="Suggested questions">
          <div class="sidebar-title">Suggested questions</div>
          <div class="sidebar-chip" role="status">
            <span class="sidebar-chip-dot" aria-hidden="true"></span>
            <span>Powered by Google Gemini AI</span>
          </div>

          <div>
            <h3 class="sidebar-section-title">About ErgoMatrix</h3>
            <div class="example-list">
              <button class="example-pill" aria-label="Ask: What is ErgoMatrix and what problem does it solve?">
                What is ErgoMatrix and what problem does it solve?
              </button>
              <button class="example-pill" aria-label="Ask: How is ErgoMatrix different from a normal ergonomic chair?">
                How is ErgoMatrix different from a normal ergonomic chair?
              </button>
              <button class="example-pill" aria-label="Ask: What is the future vision of ErgoMatrix?">
                What is the future vision of ErgoMatrix?
              </button>
            </div>
          </div>

          <div>
            <h3 class="sidebar-section-title">Products & usage</h3>
            <div class="example-list">
              <button class="example-pill" aria-label="Ask: What is the Eye-Q Sensor and how does it work?">
                What is the Eye-Q Sensor and how does it work?
              </button>
              <button class="example-pill" aria-label="Ask: What is the Mesh-Up and how does it feel?">
                What is the Mesh-Up and how does it feel?
              </button>
              <button class="example-pill" aria-label="Ask: How do I set up the full Posture Pro system?">
                How do I set up the full Posture Pro system?
              </button>
            </div>
          </div>

          <div>
            <h3 class="sidebar-section-title">Posture & pain</h3>
            <div class="example-list">
              <button class="example-pill" aria-label="Ask: My lower back hurts while working. How can Posture Pro help?">
                My lower back hurts while working. How can Posture Pro help?
              </button>
              <button class="example-pill" aria-label="Ask: What is a healthy distance from my screen?">
                What is a healthy distance from my screen?
              </button>
              <button class="example-pill" aria-label="Ask: What daily posture habits do you recommend for desk workers?">
                What daily posture habits do you recommend for desk workers?
              </button>
            </div>
          </div>

          <div>
            <h3 class="sidebar-section-title">Website & credits</h3>
            <div class="example-list">
              <button class="example-pill" aria-label="Ask: Who created this website and this AI?">
                Who created this website and this AI?
              </button>
              <button class="example-pill" aria-label="Ask: What pages does the ErgoMatrix website have?">
                What pages does the ErgoMatrix website have?
              </button>
            </div>
          </div>
        </aside>

        <!-- Chat -->
        <section class="chat-shell" aria-label="Chat interface">
          <div class="chat-header">
            <div class="chat-badge">
              <div class="chat-avatar" aria-hidden="true"></div>
              <div class="chat-meta">
                <div class="chat-meta-title">ErgoMatrix AI Coach</div>
                <div class="chat-meta-sub">Powered by Google Gemini</div>
              </div>
            </div>
            <div class="chat-controls">
              <button class="chat-control-btn" id="clearChat" aria-label="Clear chat history">Clear</button>
            </div>
          </div>

          <div class="chat-body" id="chatBody" role="log" aria-live="polite" aria-atomic="false" aria-relevant="additions">
            <div class="msg-row bot">
              <div class="msg-avatar" aria-hidden="true"></div>
              <div>
                <div class="msg-bubble">
                  Hi! I am the ErgoMatrix AI coach powered by Google Gemini. Ask me about ErgoMatrix, the Eye-Q Sensor, Mesh-Up,
                  Posture Pro, posture tips, or this website.
                </div>
                <div class="msg-meta" aria-label="Message from AI coach">AI Coach · Google Gemini</div>
              </div>
            </div>
          </div>

          <div class="typing-indicator" id="typingIndicator" role="status" aria-live="polite" aria-label="Coach is thinking">
            <span>Coach is thinking</span>
            <div class="dot" aria-hidden="true"></div>
            <div class="dot" aria-hidden="true"></div>
            <div class="dot" aria-hidden="true"></div>
          </div>

          <div class="chat-footer">
            <div class="input-row">
              <label for="promptInput" class="sr-only">Type your question about ErgoMatrix or posture</label>
              <input
                type="text"
                id="promptInput"
                class="prompt-input"
                placeholder="Type a question about ErgoMatrix, posture, or this website..."
                aria-describedby="inputHint"
              />
              <button class="send-btn" id="sendBtn" aria-label="Send message">Send</button>
            </div>
            <div class="footer-meta" id="inputHint">
              <span>Powered by Google Gemini AI</span>
              <span>Responses focused on ErgoMatrix and posture</span>
            </div>
          </div>
        </section>
      </section>
    </div>
  </main>

  <footer>
    <div class="footer-shell">
      <div class="footer-name">ErgoMatrix</div>
      <div class="footer-credits">
        Website by <span>Aetheron Web Services</span>
      </div>
      <div class="footer-links">
        <a href="#">Privacy</a>
        <a href="#">Terms</a>
        <a href="credits.html">Credits</a>
      </div>
    </div>
  </footer>

  <script>
    // ⚠️ SECURITY WARNING: Never expose API keys in production client-side code
    // This is for development/testing only. Use a backend proxy in production.
    const GEMINI_API_KEY = "YOUR_GEMINI_API_KEY_HERE"; // Replace with your actual API key from https://aistudio.google.com/apikey

    // Header scroll effect
    const navShell = document.getElementById("navShell");
    window.addEventListener("scroll", () => {
      if (!navShell) return;
      if (window.scrollY > 20) {
        navShell.classList.add("scrolled");
      } else {
        navShell.classList.remove("scrolled");
      }
    });

    const chatBody = document.getElementById("chatBody");
    const typingIndicator = document.getElementById("typingIndicator");
    const promptInput = document.getElementById("promptInput");
    const sendBtn = document.getElementById("sendBtn");
    const clearBtn = document.getElementById("clearChat");
    const exampleButtons = document.querySelectorAll(".example-pill");

    // Knowledge base for context
    const contextInfo = `
    You are the ErgoMatrix AI Coach. You help answer questions about:
    
    - ErgoMatrix: A posture-focused health tech company that prevents chronic pain from long sitting
    - Eye-Q Sensor: A desk sensor that measures head-to-screen distance
    - Mesh-Up: A universal mesh chair cover with haptic feedback modules
    - Posture Pro: The complete system combining Eye-Q Sensor and Mesh-Up
    - Posture tips for desk workers
    - This website created by Tanuj Sharma and Sparsh Jain
    
    Keep responses concise, helpful, and focused on ErgoMatrix products and posture health.
    If asked about topics outside this scope, politely redirect to ErgoMatrix-related questions.
    `;

    function addMessage(role, text) {
      const row = document.createElement("div");
      row.classList.add("msg-row", role === "user" ? "user" : "bot");
      row.setAttribute("role", "article");
      row.setAttribute("aria-label", `Message from ${role === "user" ? "you" : "AI coach"}`);

      const avatar = document.createElement("div");
      avatar.classList.add("msg-avatar");
      avatar.setAttribute("aria-hidden", "true");

      const contentWrap = document.createElement("div");
      const bubble = document.createElement("div");
      bubble.classList.add("msg-bubble");
      bubble.textContent = text;

      const meta = document.createElement("div");
      meta.classList.add("msg-meta");
      meta.textContent = role === "user" ? "You" : "AI Coach · Gemini";
      meta.setAttribute("aria-label", `Sender: ${role === "user" ? "You" : "AI coach"}`);

      contentWrap.appendChild(bubble);
      contentWrap.appendChild(meta);

      if (role === "user") {
        row.appendChild(contentWrap);
        row.appendChild(avatar);
      } else {
        row.appendChild(avatar);
        row.appendChild(contentWrap);
      }

      chatBody.appendChild(row);
      chatBody.scrollTop = chatBody.scrollHeight;
    }

    // Call Gemini API
    async function callGemini(userMessage) {
      const payload = {
        contents: [
          {
            parts: [
              { text: contextInfo },
              { text: `User question: ${userMessage}` }
            ]
          }
        ],
        generationConfig: {
          temperature: 0.7,
          maxOutputTokens: 800,
          topP: 0.95,
        },
        safetySettings: [
          {
            category: "HARM_CATEGORY_HARASSMENT",
            threshold: "BLOCK_MEDIUM_AND_ABOVE"
          },
          {
            category: "HARM_CATEGORY_HATE_SPEECH",
            threshold: "BLOCK_MEDIUM_AND_ABOVE"
          }
        ]
      };

      try {
        const response = await fetch(
          `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${GEMINI_API_KEY}`,
          {
            method: "POST",
            headers: {
              "Content-Type": "application/json"
            },
            body: JSON.stringify(payload)
          }
        );

        if (!response.ok) {
          const errorData = await response.json();
          console.error("API Error Response:", errorData);
          throw new Error(`API returned ${response.status}: ${errorData.error?.message || 'Unknown error'}`);
        }

        const data = await response.json();
        console.log("API Success Response:", data);
        
        // Extract text from response
        const text = data?.candidates?.[0]?.content?.parts?.[0]?.text;
        
        if (!text) {
          console.warn("No text in API response:", data);
          throw new Error("Empty response from API");
        }
        
        return text.trim();
      } catch (error) {
        console.error("Gemini API call failed:", error);
        throw error;
      }
    }

    async function sendMessage() {
      const text = promptInput.value.trim();
      if (!text) return;

      // Check if API key is configured
      if (!GEMINI_API_KEY || GEMINI_API_KEY === "YOUR_GEMINI_API_KEY_HERE") {
        addMessage("bot", "⚠️ Please configure your Google Gemini API key in the code. Get one free at https://aistudio.google.com/apikey");
        return;
      }

      addMessage("user", text);
      promptInput.value = "";

      // Show typing indicator
      typingIndicator.style.display = "flex";
      typingIndicator.setAttribute("aria-label", "Coach is thinking about your question");

      try {
        const reply = await callGemini(text);
        typingIndicator.style.display = "none";
        addMessage("bot", reply);
      } catch (err) {
        console.error("Error in sendMessage:", err);
        typingIndicator.style.display = "none";
        addMessage("bot", "Sorry, I encountered an error connecting to the AI service. Please check your API key and try again. Error: " + err.message);
      }
    }

    sendBtn.addEventListener("click", sendMessage);
    promptInput.addEventListener("keydown", (e) => {
      if (e.key === "Enter") {
        e.preventDefault();
        sendMessage();
      }
    });

    clearBtn.addEventListener("click", () => {
      chatBody.innerHTML = "";
      addMessage(
        "bot",
        "Chat cleared. Ask me anything about ErgoMatrix, Posture Pro, Eye-Q, Mesh-Up, posture tips, or this website."
      );
    });

    exampleButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        promptInput.value = btn.textContent.trim();
        promptInput.focus();
      });

      btn.addEventListener("keydown", (e) => {
        if (e.key === "Enter" || e.key === " ") {
          e.preventDefault();
          promptInput.value = btn.textContent.trim();
          promptInput.focus();
        }
      });
    });
  </script>
</body>
</html>
